<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interface de Paiement - Camping</title>
</head>
<body>
    <h2>Formulaire de Paiement</h2>

    <!-- Formulaire de paiement -->
    <form id="paiementForm">
        <label for="nom">Nom :</label>
        <input type="text" id="nom" name="nom" required><br><br>

        <label for="email">Email :</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="montant">Montant payé :</label>
        <input type="number" id="montant" name="montant" value="60" readonly><br><br>

        <button type="submit">Envoyer le code d'accès</button>
    </form>

    <script>
        // Générer un code aléatoire pour chaque client
        function generateRandomCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase(); // Code aléatoire
        }

        // Sauvegarder le code généré dans le localStorage pour la validation future
        function storeAccessCode(code) {
            localStorage.setItem('accessCode', code);  // Sauvegarde le code dans localStorage
        }

        // Fonction pour envoyer un email avec le code
        function sendEmail(clientEmail, accessCode) {
            const emailSubject = "Votre code d'accès pour le jeu";
            const emailBody = `Bonjour,\n\nVoici votre code d'accès pour le jeu : ${accessCode}\nLien vers le jeu : https://girlyapremidi.netlify.app/jeu\n\nCordialement, L'équipe du Camping.`;
            window.location.href = `mailto:${clientEmail}?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;
        }

        // Lors de la soumission du formulaire, générer et envoyer le code
        document.getElementById('paiementForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const nom = document.getElementById('nom').value;
            const email = document.getElementById('email').value;

            // Générer un code d'accès unique
            const accessCode = generateRandomCode();

            // Sauvegarder ce code dans le localStorage pour pouvoir vérifier plus tard
            storeAccessCode(accessCode);

            // Envoyer l'email avec le code d'accès au client
            sendEmail(email, accessCode);

            // Afficher un message de confirmation
            alert("Le code d'accès a été envoyé par email.");
        });
    </script>
</body>
</html>
